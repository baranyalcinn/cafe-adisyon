appId: com.caffio.cafeadisyon
productName: Cafe Adisyon
compression: store

directories:
  buildResources: build
  output: dist

# Standard file inclusion - includes node_modules by default
files:
  - out/**/*
  - package.json
  # Exclude source files and unnecessary artifacts
  - '!**/*.{ts,tsx}'
  - '!**/*.map'
  - '!src/**/*'
  # Note: node_modules is implicitly INCLUDED. We rely on asarUnpack for native modules.

# Unpack native modules so they can run on Windows
asar: true
asarUnpack:
  - '**/*.node'
  - '**/*.dll'
  - '**/node_modules/better-sqlite3/**/*'
  - '**/node_modules/@libsql/**/*' # Unpack entire libsql including native binaries
  - '**/node_modules/@prisma/**/*' # Unpack prisma engines
  - '**/node_modules/.prisma/**/*' # Unpack generated client

# Disable rebuilding - we rely on clean CI install
npmRebuild: false
nodeGypRebuild: false
buildDependenciesFromSource: false

win:
  executableName: cafe-adisyon
  icon: build/icon.ico
  target:
    - target: nsis
      arch: x64

portable:
  artifactName: ${productName}-Portable-${version}.${ext}

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  shortcutName: Cafe Adisyon
  deleteAppDataOnUninstall: true

appId: com.caffio.caffio
productName: Caffio
electronVersion: 39.3.0

directories:
  buildResources: build
  output: dist

compression: store
asar: true
detectUpdateChannel: false
files:
  - out/**/*
  - package.json
  # Whitelist approach: Only include EXACTLY what we need to avoid OOM
  - node_modules/@libsql/**
  - node_modules/libsql/**
  - node_modules/@prisma/client/**
  - node_modules/@prisma/adapter-libsql/**
  - node_modules/.prisma/client/**
  - node_modules/js-base64/**
  - node_modules/ws/**
  - node_modules/cross-fetch/**
  - node_modules/node-fetch/**
  - node_modules/node-fetch-native/**
  - node_modules/whatwg-url/**
  - node_modules/webidl-conversions/**
  - node_modules/tr46/**
  - node_modules/web-streams-polyfill/**
  - node_modules/data-uri-to-buffer/**
  - node_modules/fetch-blob/**
  - node_modules/formdata-polyfill/**
  - node_modules/bufferutil/**
  - node_modules/utf-8-validate/**
  - node_modules/detect-libc/**
  - node_modules/promise-limit/**
  - node_modules/async-mutex/**
  - node_modules/@neon-rs/load/**

  # Kaynak kodları hariç tut
  - '!**/*.ts'
  - '!**/*.tsx'
  - '!**/*.map'
  - '!**/README.md'
  - '!**/LICENSE'
  - '!**/CHANGELOG.md'
  - '!.git'
  - '!.github'
  - '!.vscode'
  - '!src'
  - '!prisma/*.db'
  - '!prisma/*.db-*'

# ASAR dışında tutulması gereken native modüller
asarUnpack:
  - '**/*.node'
  - 'node_modules/@libsql/**/*'
  - 'node_modules/libsql/**/*'
  - 'node_modules/@neon-rs/**/*'
  - 'node_modules/.prisma/**/*'
  - 'node_modules/bufferutil/**/*'
  - 'node_modules/utf-8-validate/**/*'
  - 'node_modules/detect-libc/**/*'

npmRebuild: false
buildDependenciesFromSource: false

win:
  executableName: cafe-adisyon
  icon: resources/icon.png
  target:
    - target: portable
      arch: x64

portable:
  artifactName: ${productName}-Portable-${version}.${ext}
  requestExecutionLevel: user

extraResources:
  - from: resources
    to: resources
  - from: prisma/dev.db
    to: initial.db
  - from: prisma/schema.prisma
    to: schema.prisma
